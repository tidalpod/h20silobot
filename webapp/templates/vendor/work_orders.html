{% extends "vendor/base.html" %}

{% block title %}Work Orders{% endblock %}

{% block content %}
<div class="flex items-center justify-between mb-4">
    <h1 class="text-xl font-bold text-gray-900">Work Orders</h1>
    <span class="text-sm text-gray-500">{{ work_orders|length }} total</span>
</div>

{% if not work_orders %}
<div class="portal-card p-8 text-center">
    <svg class="w-12 h-12 mx-auto text-gray-300 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63" />
    </svg>
    <p class="text-gray-500 font-medium">No work orders assigned</p>
    <p class="text-sm text-gray-400 mt-1">Check back later for new assignments</p>
</div>
{% else %}
<div class="space-y-3">
    {% for wo in work_orders %}
    <a href="/vendor/work-orders/{{ wo.id }}" class="portal-card p-4 block hover:shadow-md transition-shadow">
        <div class="flex items-start justify-between mb-2">
            <h3 class="text-sm font-semibold text-gray-900">{{ wo.title }}</h3>
            <span class="text-xs px-2 py-0.5 rounded-full flex-shrink-0 ml-2
                {% if wo.status.value == 'new' %}bg-blue-100 text-blue-700
                {% elif wo.status.value == 'assigned' %}bg-amber-100 text-amber-700
                {% elif wo.status.value == 'in_progress' %}bg-purple-100 text-purple-700
                {% elif wo.status.value == 'completed' %}bg-green-100 text-green-700
                {% elif wo.status.value == 'closed' %}bg-gray-100 text-gray-600
                {% endif %}">{{ wo.status.value|replace('_', ' ')|title }}</span>
        </div>
        <div class="text-xs text-gray-500 space-y-1">
            {% if wo.property_ref %}
            <div class="flex items-center gap-1">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                </svg>
                {{ wo.property_ref.address }}
            </div>
            {% endif %}
            {% if wo.scheduled_date %}
            <div class="flex items-center gap-1">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25" />
                </svg>
                Scheduled: {{ wo.scheduled_date.strftime('%b %d, %Y') }}
            </div>
            {% endif %}
            {% if wo.priority %}
            <div class="flex items-center gap-1">
                <span class="w-2 h-2 rounded-full
                    {% if wo.priority.value == 'emergency' %}bg-red-500
                    {% elif wo.priority.value == 'high' %}bg-orange-500
                    {% elif wo.priority.value == 'normal' %}bg-blue-500
                    {% else %}bg-gray-400
                    {% endif %}"></span>
                {{ wo.priority.value|title }} priority
            </div>
            {% endif %}
        </div>
        {% if wo.photos %}
        <div class="mt-2 flex gap-1">
            {% for photo in wo.photos[:3] %}
            <div class="w-10 h-10 rounded bg-gray-100 overflow-hidden">
                <img src="{{ photo.url }}" class="w-full h-full object-cover" alt="">
            </div>
            {% endfor %}
            {% if wo.photos|length > 3 %}
            <div class="w-10 h-10 rounded bg-gray-100 flex items-center justify-center text-xs text-gray-500">+{{ wo.photos|length - 3 }}</div>
            {% endif %}
        </div>
        {% endif %}
    </a>
    {% endfor %}
</div>
{% endif %}
{% endblock %}
