{% extends "portal/base.html" %}

{% block title %}Water Bills{% endblock %}

{% block content %}
<h1 class="text-xl font-bold text-gray-900 mb-6">Water Bill History</h1>

{% if bills %}
<div class="space-y-3">
    {% for bill in bills %}
    <div class="portal-card p-4">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-900">
                    {% if bill.statement_date %}{{ bill.statement_date.strftime('%b %Y') }}{% else %}Bill{% endif %}
                </p>
                <p class="text-xs text-gray-500">
                    {% if bill.due_date %}Due {{ bill.due_date.strftime('%b %d, %Y') }}{% endif %}
                    {% if bill.billing_period_start and bill.billing_period_end %}
                    &middot; {{ bill.billing_period_start.strftime('%b %d') }} - {{ bill.billing_period_end.strftime('%b %d') }}
                    {% endif %}
                </p>
            </div>
            <div class="text-right">
                <p class="text-lg font-bold {% if bill.amount_due and bill.amount_due > 0 %}text-blue-600{% else %}text-green-600{% endif %}">
                    ${{ "{:,.2f}".format(bill.amount_due) if bill.amount_due else '0.00' }}
                </p>
                {% if bill.water_usage_gallons %}
                <p class="text-xs text-gray-500">{{ "{:,}".format(bill.water_usage_gallons) }} gal</p>
                {% endif %}
            </div>
        </div>
        {% if bill.current_charges or bill.previous_balance or bill.late_fees %}
        <div class="mt-3 pt-3 border-t border-gray-100 grid grid-cols-3 gap-2 text-xs">
            {% if bill.current_charges %}
            <div>
                <span class="text-gray-500">Current</span>
                <p class="font-medium">${{ "{:,.2f}".format(bill.current_charges) }}</p>
            </div>
            {% endif %}
            {% if bill.previous_balance %}
            <div>
                <span class="text-gray-500">Previous</span>
                <p class="font-medium">${{ "{:,.2f}".format(bill.previous_balance) }}</p>
            </div>
            {% endif %}
            {% if bill.late_fees and bill.late_fees > 0 %}
            <div>
                <span class="text-gray-500">Late Fees</span>
                <p class="font-medium text-red-600">${{ "{:,.2f}".format(bill.late_fees) }}</p>
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% else %}
<div class="portal-card p-8 text-center">
    <span class="text-3xl">ðŸ’§</span>
    <h3 class="mt-2 text-sm font-semibold text-gray-900">No bills yet</h3>
    <p class="mt-1 text-xs text-gray-500">Water bill history will appear here.</p>
</div>
{% endif %}
{% endblock %}
